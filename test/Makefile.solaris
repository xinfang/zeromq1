#
#    Copyright (c) 2007 FastMQ Inc.
#
#    This file is part of 0MQ.
#
#    0MQ is free software; you can redistribute it and/or modify
#    it under the terms of the GNU General Public License as published by
#    the Free Software Foundation; either version 3 of the License, or
#    (at your option) any later version.
#
#    0MQ is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU General Public License for more details.
#
#    You should have received a copy of the GNU General Public License
#    along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

# --- test parameters ---------------------------------------------------------

TEST_MSG_COUNT_LATENCY = 50000
TEST_MSG_COUNT_THRPUT = 1000000
TEST_MSG_SIZE = 6
PORT_NUMBER = 5555

# --- do not edit below thie line -- (unles you know what you are doing) ------

PERF_HEADERS = ../perf/helpers/time.hpp ../perf/interfaces/i_transport.hpp \
	../perf/transports/tcp.hpp ../perf/transports/sctp.hpp \
	../perf/transports/zmq.hpp  ../perf/interfaces/i_worker.hpp \
	../perf/workers/raw_sender.hpp ../perf/workers/raw_receiver.hpp \
	../perf/workers/receiver.hpp ../perf/workers/sender.hpp \
	../perf/workers/echo.hpp ../perf/workers/ping_pong.hpp 
ZMQ_HEADERS = ../zmq/kernel.hpp ../zmq/atomic_ptr.hpp ../zmq/socket.hpp \
	../zmq/ysocketpair.hpp ../zmq/ypipe.hpp ../zmq/err.hpp ../zmq/ysemaphore.hpp \
	../zmq/wire.hpp

CC = g++
CCFLAGS = -Wall

all	: local remote

local	:	$(PERF_HEADERS) $(ZMQ_HEADERS) local.cpp
	$(CC) $(CCFLAGS) local.cpp -D'PORT_NUMBER=$(PORT_NUMBER)' \
	-D'TEST_MSG_COUNT_LATENCY=$(TEST_MSG_COUNT_LATENCY)' \
	-D'TEST_MSG_COUNT_THRPUT=$(TEST_MSG_COUNT_THRPUT)' \
	-D'TEST_MSG_SIZE=$(TEST_MSG_SIZE)' -o local -lpthread \
	-lsocket -lnsl -lrt
remote	:	$(PERF_HEADERS) $(ZMQ_HEADERS) remote.cpp
	$(CC) $(CCFLAGS) remote.cpp -D'PORT_NUMBER=$(PORT_NUMBER)' \
	-D'TEST_MSG_COUNT_LATENCY=$(TEST_MSG_COUNT_LATENCY)' \
	-D'TEST_MSG_COUNT_THRPUT=$(TEST_MSG_COUNT_THRPUT)' \
	-D'TEST_MSG_SIZE=$(TEST_MSG_SIZE)' -o remote -lpthread \
	-lsocket -lnsl -lrt
clean	:
		-rm -f local
		-rm -f remote
		-rm -f in.dat
		-rm -f out.dat
